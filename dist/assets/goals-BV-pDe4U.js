import{o as w,a as u,g as P,d as C}from"./app-CUjJh8TF.js";import{collection as E,query as _,orderBy as S,onSnapshot as T,addDoc as $,serverTimestamp as p,deleteDoc as I,doc as v,updateDoc as A}from"https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore.js";const N="modulepreload",k=function(t){return"/"+t},B={},h=function(e,o,r){let n=Promise.resolve();if(o&&o.length>0){let b=function(c){return Promise.all(c.map(m=>Promise.resolve(m).then(g=>({status:"fulfilled",value:g}),g=>({status:"rejected",reason:g}))))};document.getElementsByTagName("link");const a=document.querySelector("meta[property=csp-nonce]"),s=a?.nonce||a?.getAttribute("nonce");n=b(o.map(c=>{if(c=k(c),c in B)return;B[c]=!0;const m=c.endsWith(".css"),g=m?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${g}`))return;const d=document.createElement("link");if(d.rel=m?"stylesheet":N,m||(d.as="script"),d.crossOrigin="",d.href=c,s&&d.setAttribute("nonce",s),document.head.appendChild(d),m)return new Promise((D,L)=>{d.addEventListener("load",D),d.addEventListener("error",()=>L(new Error(`Unable to preload CSS for ${c}`)))})}))}function l(a){const s=new Event("vite:preloadError",{cancelable:!0});if(s.payload=a,window.dispatchEvent(s),!s.defaultPrevented)throw a}return n.then(a=>{for(const s of a||[])s.status==="rejected"&&l(s.reason);return e().catch(l)})};let i=null,y=null;function f(t){return String(t||"").replace(/[&<>\\\"]/g,e=>({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;"})[e])}function M(t){t.innerHTML="<p>No saved goals yet.</p>"}function R(t){const e=t.data(),o=document.createElement("div");return o.className="goal-card",o.innerHTML=`
          <strong>${f(e.title)}</strong> â€” <em>${f(e.career)}</em>
          <div class="goal-meta">${f(e.details||"")}</div>
          <div class="goal-meta">Target date: ${f(e.byDate||"")}</div>
          <div class="goal-controls">
            <button data-id="${t.id}" class="small-btn btn-secondary editBtn">Edit</button>
            <button data-id="${t.id}" class="small-btn btn-primary deleteBtn">Delete</button>
          </div>
        `,o}function q(t){t.addEventListener("click",async e=>{const o=e.target.closest(".editBtn"),r=e.target.closest(".deleteBtn");if(o){const n=o.dataset.id,a=(await(await h(()=>import("https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore.js"),[])).getDoc(v(u,"users",i.uid,"goals",n))).data();document.getElementById("career").value=a.career||"",document.getElementById("title").value=a.title||"",document.getElementById("details").value=a.details||"",document.getElementById("byDate").value=a.byDate||"",y=n,document.getElementById("saveBtn").textContent="Save Changes"}if(r){const n=r.dataset.id;confirm("Delete this goal?")&&await I(v(u,"users",i.uid,"goals",n))}})}w(async t=>{if(i=t,!t){const n=document.getElementById("goalsList");n.innerHTML="<p>Please sign in to save and view goals.</p>";return}const e=document.getElementById("goalsList"),o=E(u,"users",t.uid,"goals"),r=_(o,S("createdAt","desc"));q(e),T(r,n=>{if(e.innerHTML="",n.empty){M(e);return}n.forEach(l=>{const a=R(l);e.appendChild(a)})})});document.addEventListener("DOMContentLoaded",()=>{const t=document.getElementById("goalForm"),e=document.getElementById("clearBtn");t.addEventListener("submit",async o=>{if(o.preventDefault(),!i){alert("Please sign in to save goals.");return}const r=document.getElementById("career").value.trim(),n=document.getElementById("title").value.trim(),l=document.getElementById("details").value.trim(),a=document.getElementById("byDate").value;if(!r||!n||!a){alert("Please fill career, title and target date.");return}const s=E(u,"users",i.uid,"goals");y?(await A(v(u,"users",i.uid,"goals",y),{career:r,title:n,details:l,byDate:a,updatedAt:p()}),y=null,document.getElementById("saveBtn").textContent="Save Goal"):await $(s,{career:r,title:n,details:l,byDate:a,createdAt:p()}),t.reset()}),e.addEventListener("click",async()=>{if(!i){alert("Please sign in to clear goals.");return}if(confirm("Clear all saved goals?")){const o=E(u,"users",i.uid,"goals"),n=(await(await h(()=>import("https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore.js"),[])).getDocs(o)).docs.map(l=>I(v(u,"users",i.uid,"goals",l.id)));await Promise.all(n)}})});const H=localStorage.getItem("goalDocID");async function x(t){if(!t)return console.warn("No goal ID found");try{const e=await P(C(u,"careerGoals",t));e.exists()?document.getElementById("goalTitle").textContent=e.data().title:console.log("No such career goal found!")}catch(e){console.error("Error getting goal document:",e)}}x(H);
